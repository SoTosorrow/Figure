<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>demo01</title>
</head>
<body>
    <center>
<video id="myVideo" width="500" height="400" src=""></video>
 <br>
 <canvas id="mycanvas" width="500" height="400"></canvas>
</center>
 <script>
     /**
      * https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial/Basic_animations
      */
     var myVideo = document.getElementById('myVideo');
        navigator.mediaDevices.getUserMedia({
            video: true
        }).then(function (mediaStream) {
            myVideo.srcObject = mediaStream;
            myVideo.onloadedmetadata = function () {
            myVideo.controls = "controls";
            myVideo.play();
            }
        });
    var canvas = document.getElementById('mycanvas').getContext('2d'),
        snapScreen = document.getElementById('snapScreen'),
        video = document.getElementById('myVideo');
    let func = function () {
        window.requestAnimationFrame(func);
        canvas.drawImage(video, 0, 0, 500, 400);
        // var obj=canvas.getImageData(0,0,100,100);  
        // canvas.putImageData(obj,110,0);
        for(let i=0;i<50000;i++){
            canvas.fillRect(0,0,100,100);
        }
        // var obj=canvas.getImageData(0,0,400,400);
        // for(let i=0;i<obj.data.length;i++){
        //     obj.data[0+4*i] = Math.floor(Math.random()*255)
        //     obj.data[1+4*i] = Math.floor(Math.random()*255)
        //     obj.data[2+4*i] = Math.floor(Math.random()*255)
        //     obj.data[3+4*i] = Math.floor(Math.random()*255)
        // }
        canvas.putImageData(obj,0,0);
    }
    // func();

    let i = 0;
    let effectImage = canvas.createImageData(500,400);
    let effect = ()=>{
        window.requestAnimationFrame(effect);
        canvas.drawImage(video, 0, 0, 500, 400);

        let image = canvas.getImageData(0,0,500,400);
        for(let j=0;j<500;j++){
            effectImage.data[0+4*(i+j)] = image.data[0+4*(i+j)]
            effectImage.data[1+4*(i+j)] = image.data[1+4*(i+j)]
            effectImage.data[2+4*(i+j)] = image.data[2+4*(i+j)]
            effectImage.data[3+4*(i+j)] = image.data[3+4*(i+j)]
        }
        i+=500;
        for(let n=i;n<image.data.length;n++){
            effectImage.data[0+4*n] = image.data[0+4*n]
            effectImage.data[1+4*n] = image.data[1+4*n]
            effectImage.data[2+4*n] = image.data[2+4*n]
            effectImage.data[3+4*n] = image.data[3+4*n]
        }

        // line
        for(let temp=0;temp<1;temp++){
            for(let l=0;l<500;l++){
                effectImage.data[0+4*(l+temp+i)] = 0
                effectImage.data[1+4*(l+temp+i)] = 0
                effectImage.data[2+4*(l+temp+i)] = 255
                effectImage.data[3+4*(l+temp+i)] = 255
            }
        }
        canvas.putImageData(effectImage,0,0);
    }
    effect();
   
 </script>
</body>
</html> 